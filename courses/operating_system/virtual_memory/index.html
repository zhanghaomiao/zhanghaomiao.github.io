<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Haomiao Zhang">

  
  
  
    
  
  <meta name="description" content="Background  We don&rsquo;t want to run a program that is entirely in memory  Many code for handling unusual errors or conditions Certain program routines or features are rarely used The same library code used by many programs Arrays, lists and tables allocated but not used  Virtual memory — separation of user logical memory from physical memory  To run a extremely large process, logical address space can be much larger than the physical address space To increase CPU/resources utilization (higher degree of multiprogramming degree) To simplify programming tasks (Free programmer from memory limitation) To run programs faster (less I/O would be needed to load or swap)  Virtual memory can be implemented by  Demand paging Demand segmentation: more complicated due to variable size    Demand Paging  A program rather than the whole process is brought into memory only when it is needed  Less I/O needed $\rightarrow$ Faster response Less memory needed $\rightarrow$ More users  Page is needed when there is a reference to the page  Invalid reference $\rightarrow$ abort Not-in-memory $\rightarrow$ bring to memory via paging  Pure demand paging  Start a process with no page Never bring a page into memory until it is required  A swapper (midterm scheduler) manipulates the entire process, whereas a pager is concerned with individual page of a process Hardware support  Page table : a valid-invalid bit (1 $\rightarrow$ page in memory, $0 \rightarrow$ page no in the memory) Secondary memory (swap space, backing store), usually, a high-speed disk (swap device) is use    Page Fault First reference to a page will trap to OS (page fault trap)">

  
  <link rel="alternate" hreflang="en-us" href="/courses/operating_system/virtual_memory/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-light.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-light.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/courses/operating_system/virtual_memory/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Haomiao">
  <meta property="og:url" content="/courses/operating_system/virtual_memory/">
  <meta property="og:title" content="Virtual Memory | Haomiao">
  <meta property="og:description" content="Background  We don&rsquo;t want to run a program that is entirely in memory  Many code for handling unusual errors or conditions Certain program routines or features are rarely used The same library code used by many programs Arrays, lists and tables allocated but not used  Virtual memory — separation of user logical memory from physical memory  To run a extremely large process, logical address space can be much larger than the physical address space To increase CPU/resources utilization (higher degree of multiprogramming degree) To simplify programming tasks (Free programmer from memory limitation) To run programs faster (less I/O would be needed to load or swap)  Virtual memory can be implemented by  Demand paging Demand segmentation: more complicated due to variable size    Demand Paging  A program rather than the whole process is brought into memory only when it is needed  Less I/O needed $\rightarrow$ Faster response Less memory needed $\rightarrow$ More users  Page is needed when there is a reference to the page  Invalid reference $\rightarrow$ abort Not-in-memory $\rightarrow$ bring to memory via paging  Pure demand paging  Start a process with no page Never bring a page into memory until it is required  A swapper (midterm scheduler) manipulates the entire process, whereas a pager is concerned with individual page of a process Hardware support  Page table : a valid-invalid bit (1 $\rightarrow$ page in memory, $0 \rightarrow$ page no in the memory) Secondary memory (swap space, backing store), usually, a high-speed disk (swap device) is use    Page Fault First reference to a page will trap to OS (page fault trap)"><meta property="og:image" content="img/map[gravatar:%!s(bool=true) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=true) shape:circle]"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-05T00:00:00&#43;01:00">
    
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  

  



  


  


  





  <title>Virtual Memory | Haomiao</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Haomiao</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Haomiao</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/post/"><span>Posts</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/courses/"><span>All Courses</span></a>
            
              <a class="dropdown-item" href="/courses/operating_system"><span>Operating system</span></a>
            
              <a class="dropdown-item" href="/courses/computer_network"><span>Computer network</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/operating_system/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/operating_system/os_structures/">Concepts</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/operating_system/os_structures/">OS structures</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/process/">Process</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/memory_manage/">Memory Management</a>
      </li>
      
      <li class="active">
        <a href="/courses/operating_system/virtual_memory/">Virtual Memory</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/multithread_programming/">Multithread Programming</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/process_schedule/">Process Scheduling</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/process_synchronization/">Process Synchronization</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/deadlocks/">DeadLocks</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/file_system_interface/">File System Interface</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/file_system_implementatin/">File System Implementation</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/mass_storage_system/">Mass Storage System</a>
      </li>
      
      <li >
        <a href="/courses/operating_system/io_system/">I/O system</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/deep_learning/cnn/">Convolutional Neural Networks</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/deep_learning/cnn/">Foundations of Convolutional Neural Networks</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#background">Background</a></li>
<li><a href="#demand-paging">Demand Paging</a>
<ul>
<li><a href="#page-fault">Page Fault</a></li>
<li><a href="#page-replacement">Page replacement</a></li>
<li><a href="#demand-paging-performance">Demand Paging Performance</a></li>
<li><a href="#process-creation-and-virtual-memory">Process Creation and Virtual memory</a></li>
<li><a href="#copy-on-write">Copy-on-Write</a></li>
<li><a href="#memory-mapped-files">Memory-Mapped Files</a></li>
</ul></li>
<li><a href="#page-replacement-1">Page replacement</a>
<ul>
<li><a href="#page-replacement-algorithms">Page Replacement Algorithms</a></li>
<li><a href="#fifo-algorithm">FIFO algorithm</a></li>
<li><a href="#optimal-belady-algorithm">Optimal (Belady) Algorithm</a></li>
<li><a href="#lru-algorithm-least-recently-used">LRU Algorithm (Least Recently Used)</a>
<ul>
<li><a href="#stack-algorithm">Stack Algorithm</a></li>
</ul></li>
<li><a href="#lru-approximation-algorithms">LRU approximation algorithms</a></li>
<li><a href="#counting-algorithms">Counting Algorithms</a></li>
</ul></li>
<li><a href="#allocation-of-frames">Allocation of frames</a>
<ul>
<li><a href="#trashing">Trashing</a>
<ul>
<li><a href="#working-set-model-实现起来比较繁琐-比较少用">Working-Set Model (实现起来比较繁琐， 比较少用)</a></li>
<li><a href="#page-fault-frequency-scheme">Page Fault frequency scheme</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Virtual Memory</h1>

          <div class="article-style">
            

<h2 id="background">Background</h2>

<ul>
<li>We don&rsquo;t want to run a program that is entirely in memory

<ol>
<li>Many code for handling unusual errors or conditions</li>
<li>Certain program routines or features are rarely used</li>
<li>The same library code used by many programs</li>
<li>Arrays, lists and tables allocated but not used</li>
</ol></li>
<li>Virtual memory — separation of user logical memory from physical memory

<ul>
<li>To run a extremely <strong>large process</strong>, logical address space can be much larger than the physical address space</li>
<li>To increase <strong>CPU/resources utilization</strong> (higher degree of multiprogramming degree)</li>
<li>To <strong>simplify programming</strong> tasks (Free programmer from memory limitation)</li>
<li>To run programs <strong>faster</strong> (less I/O would be needed to load or swap)</li>
</ul></li>
<li>Virtual memory can be implemented by

<ul>
<li>Demand paging</li>
<li>Demand segmentation: more complicated due to variable size
<img src="https://i.loli.net/2019/03/17/5c8de51380ac7.png" width="400px"/></li>
</ul></li>
</ul>

<h2 id="demand-paging">Demand Paging</h2>

<ul>
<li>A program rather than the whole process is brought into memory only when it is needed

<ul>
<li>Less I/O needed $\rightarrow$ Faster response</li>
<li>Less memory needed $\rightarrow$ More users</li>
</ul></li>
<li>Page is needed when there is a reference to the page

<ul>
<li>Invalid reference $\rightarrow$ abort</li>
<li>Not-in-memory $\rightarrow$ bring to memory via paging</li>
</ul></li>
<li>Pure demand paging

<ul>
<li>Start a process with no page</li>
<li>Never bring a page into memory until it is required</li>
</ul></li>
<li>A swapper (midterm scheduler) manipulates the entire process, whereas a pager is concerned with individual page of a process</li>
<li>Hardware support

<ul>
<li>Page table : a valid-invalid bit (1 $\rightarrow$ page in memory, $0 \rightarrow$ page no in the memory)</li>
<li>Secondary memory (swap space, backing store), usually, a high-speed disk (swap device) is use
<img src="https://i.loli.net/2019/04/01/5ca1897edd6c1.png" width="400px"/></li>
</ul></li>
</ul>

<h3 id="page-fault">Page Fault</h3>

<p>First reference to a page will trap to OS (page fault trap)</p>

<ol>
<li>OS looks at the internal table (PCB) to decide

<ul>
<li>Invalid reference $\rightarrow$ abort</li>
<li>Just not in memory $\rightarrow$ continue</li>
</ul></li>
<li>Get an empty frame</li>
<li>Swap the page from disk (swap) space into the frame</li>
<li>Reset page table, invalid-valid bit = 1</li>
<li>Restart instruction
<img src="https://i.loli.net/2019/03/17/5c8dea0ea45c7.png" width="400px"/></li>
</ol>

<h3 id="page-replacement">Page replacement</h3>

<p>If there is no free frame when a page fault occurs</p>

<ul>
<li>swap a frame to backing store</li>
<li>swap a page from backing store into the frame</li>
<li>different page <strong>replacement algorithms</strong> pick different frames for replacement</li>
</ul>

<h3 id="demand-paging-performance">Demand Paging Performance</h3>

<ul>
<li>Effective Access Time (EAT): $(1-p) \times ma + p \times PFT$

<ul>
<li>P: page fault rate, ma: memory, access time, PFT: page fault time</li>
</ul></li>
<li>Example ma=200ns, PFT=8ms

<ul>
<li>EAT = 200ns + 7999800 ns $\times$ p</li>
</ul></li>
<li>Access time is proportional to the page fault rate

<ul>
<li>If one access out of 1000 causes a page fault, then EAT = 8.2 ms $\rightarrow$ slowdown by a factor of 40</li>
</ul></li>
<li>Programs tend to have locality of reference</li>
<li>Locality means program often accesses memory addresses that are close together

<ul>
<li>A single page fault can bring in 4KB memory content</li>
<li>Greatly reduce the occurrence of page fault</li>
</ul></li>
<li>Major components of page fault time (about 8ms)

<ol>
<li>serve the page-fault interrupt</li>
<li><strong>read in the page from disk</strong> (most expensive)</li>
<li>Restart the process</li>
</ol></li>
</ul>

<h3 id="process-creation-and-virtual-memory">Process Creation and Virtual memory</h3>

<ul>
<li>Demand paging: only bring in the page containing the first instruction</li>
<li>Copy-on-Write: the parent and the child process share the same frames initially, and frame-copy when a page is written</li>
<li>Memory-Mapped File: map a file into the virtual address space to bypass file system calls (e.g. read(), write())</li>
</ul>

<h3 id="copy-on-write">Copy-on-Write</h3>

<ul>
<li>if either process modifies a frame, only then a frame is copied</li>
<li>COW allows efficient process creation</li>
<li>Free frames are allocated from a pool of zeroed-out frames, the content of a frame is erased to 0</li>
<li>Figure: a child process is forked
<img src="https://i.loli.net/2019/03/17/5c8defdbc3767.png" width="400px"/></li>
<li>After parent modifies page C
<img src="https://i.loli.net/2019/03/17/5c8df0553a9f2.png" width="400px"/></li>
</ul>

<h3 id="memory-mapped-files">Memory-Mapped Files</h3>

<ul>
<li>Approach:

<ul>
<li>MMF allows file I/O to be treated as routine memory access by mapping a disk block to memory frame</li>
<li>A file  is initially read using demand paging. Subsequent read/writes to/from the file are treated as ordinary memory accesses</li>
</ul></li>
<li>Benefit:

<ul>
<li>Faster file access by using memory access rather than <code>read()</code> and <code>write()</code> system calls</li>
<li>Allows several process to map the SAME file allowing the pages in memory to be SHARED</li>
</ul></li>
<li>Concerns:

<ul>
<li>Security(access control), data lost, more programming efforts
<img src="https://i.loli.net/2019/03/17/5c8df3f01bddd.png" width="400px"/></li>
</ul></li>
</ul>

<h2 id="page-replacement-1">Page replacement</h2>

<ul>
<li>when a page fault occurs with on free frame

<ol>
<li>swap out a process,  freeing all its frames</li>
<li>page replacement, find one not currently used add free it.
Use <strong>dirty bit</strong> to reduce overhead of page transfers &ndash; only modified pages are written to disk</li>
</ol></li>
<li>Solve two major problems for demand paging

<ul>
<li>Frame-allocation algorithm, determine how many frames to be allocated to a process</li>
<li>Page-replacement algorithm, select which frame to be replaced</li>
</ul></li>
</ul>

<h3 id="page-replacement-algorithms">Page Replacement Algorithms</h3>

<ul>
<li>Goal: lowest page-fault rate</li>
<li>Evaluation: running against a string of memory references (reference string) and computing the number of page faults</li>
<li>Reference String: 1,2,3,4,1,2,5,1,2,3,4,5</li>
</ul>

<h3 id="fifo-algorithm">FIFO algorithm</h3>

<ol>
<li>The oldest page in a FIFO queue is replaced</li>
<li>3 frames (available memory frames = 3) 9 page faults
<img src="https://i.loli.net/2019/03/17/5c8df74139338.png" width="400px"/></li>
<li>FIFO illustrating Belady&rsquo;s Anomaly
More allocated frames doesn&rsquo;t guaranteed less page fault
<img src="https://i.loli.net/2019/03/17/5c8df806c0447.png" width="400px"/></li>
<li>Figure illustration
<img src="https://i.loli.net/2019/03/17/5c8df86990ad6.png" width="400px"/></li>
</ol>

<h3 id="optimal-belady-algorithm">Optimal (Belady) Algorithm</h3>

<ol>
<li>Replace the page that will not be used for the longest period of time, need future knowledge</li>
<li>4 frames (6 page faults)</li>
<li>In practice, we don&rsquo;t have future knowledge, only used for reference and comparison
<img src="https://i.loli.net/2019/03/17/5c8e05f397a22.png" width="400px"/>
<br /></li>
</ol>

<h3 id="lru-algorithm-least-recently-used">LRU Algorithm (Least Recently Used)</h3>

<ul>
<li>An approximation of optimal algorithm, looking backward, rather than forward</li>
<li>It replaces the page that has not been used for the longest period of time</li>
<li>It is often used, and is considered as quite good</li>
<li>Counter implementation

<ol>
<li>page referenced: time stamp is copied into the counter</li>
<li>replacement: remove the one with oldest counter, but linear search is required</li>
</ol></li>
<li>Stack implementation

<ol>
<li>page referenced: move to top of the double-linked list</li>
<li>replacement: remove the page at the bottom
<img src="https://i.loli.net/2019/03/17/5c8e078801cb9.png" width="400px"/></li>
</ol></li>
</ul>

<h4 id="stack-algorithm">Stack Algorithm</h4>

<ol>
<li>A property of algorithms</li>
<li>Stack algorithm: the set of pagers in memory for n frames is always a subset of the set of pages that would be in memory with n+1 frames</li>
<li>Stack algorithms do not suffers from Belady&rsquo;s anomaly</li>
<li>Both optimal algorithm and LRU algorithm stack algorithm</li>
</ol>

<h3 id="lru-approximation-algorithms">LRU approximation algorithms</h3>

<p>Few systems provide sufficient hardware support for the LRU page-replacement</p>

<ol>
<li>additional-reference-bits algorithm</li>
<li>second-chance algorithm</li>
<li>enhanced second-chance algorithm</li>
</ol>

<h3 id="counting-algorithms">Counting Algorithms</h3>

<ol>
<li>LFU algorithms (least frequently used)

<ul>
<li>keep a counter for each page</li>
<li>idea: an actively used page should have a large reference count</li>
</ul></li>
<li>MFU algorithms (most frequently used)

<ul>
<li>idea: the page with the smallest count was probably just brought in and has yet to be used</li>
</ul></li>
</ol>

<p>Both counting algorithms are not common</p>

<ol>
<li>implementation is expensive (overflow)</li>
<li>do not approximate OPT algorithm very well</li>
</ol>

<h2 id="allocation-of-frames">Allocation of frames</h2>

<ul>
<li>each process needs minimum number of frames</li>
<li>Fixed allocation

<ul>
<li>Equal allocation &ndash; 100 frames, 5 processes $\rightarrow$ 20 frames/process</li>
<li>Proportional allocation &ndash; Allocate according to the size of the process</li>
</ul></li>
<li>Priority allocation
Using proportional allocation based on priority, instead of size.</li>
<li>Local allocation: each process select from its own set of allocated frames</li>
<li>Global allocation : process selects a replacement frame from the set of all frames

<ul>
<li>One process can take away a frame of another process</li>
<li>e.g. Allow a high-priority process to take frames from a low-priority process</li>
<li>Good system performance and thus is common used</li>
<li>A minimum number of frames must be maintained for each process to prevent <strong>trashing</strong></li>
</ul></li>
</ul>

<h3 id="trashing">Trashing</h3>

<ul>
<li>If a process dost not have &ldquo;enough&rdquo; frames to support pages in active page $\rightarrow$ very high paging activity</li>
<li>A process is trashing if it spending more time paging than executing
<img src="https://i.loli.net/2019/03/17/5c8e0d69140ec.png" width="400px"/></li>
<li>Performance problem caused by trashing
Processes queued for I/O to swap (page fault) $\rightarrow$ low CPU utilization $\rightarrow$ OS increased the degree of multiprogramming $\rightarrow$ new processes take frames from old processes $\rightarrow$ CPU utilization drops even further</li>
<li>To prevent trashing, must provide enough frames for each process (Working-set model, page-fault frequency)</li>
</ul>

<h4 id="working-set-model-实现起来比较繁琐-比较少用">Working-Set Model (实现起来比较繁琐， 比较少用)</h4>

<ul>
<li>Locality: a set of pages that are actively used together</li>
<li>Locality model: as a process executes, it moves from locality to locality (program structure, data structure)</li>
<li>Working-set model

<ol>
<li>working-set window: a parameter $\Delta$</li>
<li>working set: set of pages in most recent $\Delta$ page reference (an approximation locality)
<img src="https://i.loli.net/2019/03/17/5c8e0fedf1e67.png" width="400px"/></li>
</ol></li>
<li>Explanation

<ul>
<li>$WSS_i:$ Working-set size  for process i</li>
<li>$D = \sum WSS_i:$  Total demand frames</li>
<li>If $D &gt; m$ (available frames) $\rightarrow$ trashing</li>
<li>The OS monitors the $WSS_i$ of each process and allocates to the process enough frames: if $D &lt;&lt; m$ , increase degree of MP, if $D &gt; m$, suspend a process.</li>
</ul></li>
<li>Advantages: prevent thrashing while keeping the degree of multiprogramming as high as possible , optimize CPU utilization</li>
</ul>

<h4 id="page-fault-frequency-scheme">Page Fault frequency scheme</h4>

<ul>
<li>page fault frequency directly measures and controls the page-fault rate to prevent trashing</li>
<li>Establish upper and lower bounds on the desired page-fault rate of a process</li>
<li>If page fault rate exceed the upper limit, allocate another frame to the process</li>
<li>if page fault rate fails below the lower limit, remove a frame from the process
<img src="https://i.loli.net/2019/03/17/5c8e249f97b68.png" width="400px"/></li>
</ul>

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/operating_system/memory_manage/" rel="next">Memory Management</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/operating_system/multithread_programming/" rel="prev">Multithread Programming</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on May 5, 2019</p>

          





  
  

<p class="edit-page">
  <a href="https://github.com/zhanghaomiao/academic-kickstart/edit/master/content/courses/operating_system/virtual_memory.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          

        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/fortran.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/c.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/java.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.c816d323c3a55093dae0829b44ea1ca8.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
